/**
error
Relation_1
REF
SELECT C_CDE, C_CNM, 'codeKind' FROM WEB_BAS_COMM_CODE WHERE C_PAR_CDE = '601' ORDER BY C_CDE 
Cur_code	默认CNY
Cla_usd_amt	默认-9999

ins_date	投保日期	YYYYMMDD
eff_date	合同生效日期	YYYYMMDD
app_cus_pro	投保人客户类型	mapping
ins_cus_pro	被保险人客户类型	mapping
benefit_type	受益人类型	mapping
relation_1	投保人被保人之间的关系	mapping
relation_2	受益人被保人之间的关系	mapping
cla_id_type	理赔申请人身份证件类型	mapping
cla_pro	理赔申请人类型	mapping
cur_code	币种	mapping
tsf_flag	支付方式	mapping
acc_type	实际领款人类型	mapping
acc_id_type	实际领款人身份证件类型	mapping
*/
select 
'' as Company_codel,-- 机构网点代码
'' as Company_code2,-- 金融机构编码
'' as Company_code3,-- 保单归属机构网点代码
'' as Company_code4,-- 受理业务机构网点代码
a.C_PLY_NO as Pol_no,-- 保单号
a.C_APP_NO as App_no,-- 投保单号
date_format(a.T_APP_TM,'%Y%m%d') as Ins_date,-- 投保日期
date_format(a.T_INSRNC_BGN_TM,'%Y%m%d') as Eff_date,-- 合同生效日期
b.C_INSURED_NME as App_name,-- 投保人名称
b.C_INSURED_CDE as App_cst_no,-- 投保人客户号
b.C_CERTF_CDE as App_id_no,-- 投保人证件号码
b.C_CLNT_MRK as App_cus_pro,-- 投保人客户类型
c.C_INSURED_NME as Ins_name,-- 被保险人客户名称
c.C_INSURED_CDE as Ins_cst_no,-- 被保险人客户号
c.C_CERTF_CDE as Ins_id_no,-- 被保险人证件号码
c.C_CLNT_MRK as Ins_cus_pro,-- 被保险人客户类型
d.C_BNFC_NME as Benefit_name,-- 受益人名称
d.C_BNFC_CERT_NO as Benefit_id_no,-- 受益人身份证件号码
'' as Benefit_type,-- 受益人类型
c.C_APP_RELATION as Relation_1,-- 投保人被保人之间的关系
'' as Relation_2,-- 受益人被保人之间的关系
e.C_RPTMAN_NME as Cla_app_name,-- 理赔申请人名称
'' as  Cla_id_type,-- 理赔申请人身份证件类型
'' as  Cla_id_no,-- 理赔申请人身份证件号码
e.C_INSURED_REL as Cla_pro,-- 理赔申请人类型
date_format(f.t_endcase_tm,'%Y%m%d') as Cla_date,-- 理赔日期
'' as Cur_code,-- 币种
g.N_AMT as Cla_amt,-- 理赔金额
'' as Cla_usd_amt,-- 折合美元金额
f.c_clm_no Cla_no,-- 赔案号
'' as Tsf_flag,-- 支付方式
g.C_PAYEE_NME as Acc_name,-- 实际领款人名称
g.C_BANK_NUM as Acc_no,-- 实际领款人账号
g.C_BANK_CDE as Acc_bank,-- 实际领款人开户机构
g.C_PUB_PIV as Acc_type,-- 实际领款人类型
g.C_CARD_TYPE as Acc_id_type,-- 实际领款人身份证件类型
g.C_ID_CARD as Acc_id_no,-- 实际领款人身份证件号码
'' as Receipt_no-- 作业流水号,唯一标识号
from ods_cthx_web_ply_base a
left join ods_cthx_web_ply_applicant b on a.c_ply_no=b.c_ply_no
left join ods_cthx_web_app_insured c on a.c_ply_no=c.c_ply_no
left join ods_cthx_web_ply_bnfc d on  a.c_ply_no=d.c_ply_no
left join ods_cthx_web_clm_rpt e
left join ods_cthx_web_clmnv_endcase f
left join ods_cthx_web_clm_bank g
